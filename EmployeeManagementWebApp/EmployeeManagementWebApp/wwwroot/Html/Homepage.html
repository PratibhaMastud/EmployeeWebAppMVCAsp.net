<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" initial-sacle=1>
    <link  href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/css/home.css" />

    <title>Home</title>
    <style>
        .scroll {
            overflow-y: scroll;
            min-width: 200px;
            height: 400px;
        }
    </style>
</head>
<body>
    <div class="topnav">
        <h3 class="h3">Employee Management System</h3>
        <a href="Homepage.html">Reset Password</a>
        <a href="Reset.html">Reset Password</a>
    </div>
    <div class="container">
        <div class="row">
            <form class="form-div">
                <div class="col-14 scroll">
                    <h4 class="h4">Employee List : </h4>
                    <table class="table table-bordered" id="employeetbl">
                        <thead>
                            <tr>
                                <td>Id</td>
                                <td>First Name</td>
                                <td>Last Name</td>
                                <td>Mobile No</td>
                                <td>Email</td>
                                <td>Address</td>
                                <td>Pincode</td>
                                <td>Company Name</td>
                                <td>Job Profile</td>
                                <td colspan="2" id="action">Action</td>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </form>
        </div>
    </div>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $.ajax({
                type: "GET",
                url: "/api/getEmployee",
                dataType: "Json",
                success: function (data) {
                    var EmployeeRecord = $("#employeetbl tbody");
                    $(data).each(function (index, employee) {
                        EmployeeRecord.append('<tr><td>' + employee.employeeId + '</td><td>' + employee.firstName + '</td><td>' + employee.lastName + '</td><td>' + employee.mobileNo + '</td><td>' + employee.email + '</td><td>' + employee.address
                            + '</td><td>' + employee.pincode + '</td><td>' + employee.companyName + '</td><td>' + employee.jobProfile + '<td>+ <a href= Edit.html><label id=edit>Edit</label></a></td>' + ' <td ><input type="button" id="deleteId" onclick="deleteRowData(' + employee.employeeId + ')" class="delete" value="Delete" ></td>');
                        console.log(employee);
                    });
                }
            });
        });

            ///Deleting Row Method
        function deleteRowData(employeeId) {
            confirm("Are You Sure");
            console.log({ "id": employeeId });
            $.ajax({
                type: "DELETE",
                url: "/api/delete/" + employeeId,
                success: function (data) {
                    alert("Data Deleted Succesfully");
                    window.location.reload();
                    return true;
                },
                error: function () {
                    alert("Something Went Wrong");
                }
            });
        }
            

    </script>

</body>
</html>
